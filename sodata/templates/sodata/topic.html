{% extends "base.html" %}

{% block content %}
{% load extra_tags %}

<div id="content-container" class="container">
  <div class="row">

    {% if resource.is_home %}

    <!-- This doesn't adhere to DRY principles. What is the best way to do that? -->  
    <div class="col-xs-12">
      <h1>{{resource.title}}</h1>   
      {% if resource.url != None %}
      <p id="url-content"><a href="{{ resource.url }}" target="_blank">{{ resource.url }}</a></p>
      {% endif %}
      <p>{% if resource.text != None %}{{ resource.text }}{%else%}This resource has no description. <a href="/resources/{{resource.id}}/edit">Add one now!</a>{% endif %}</p> 
    </div>

    {% else %}

    <div class="col-xs-8">
      <h1>{{resource.title}}</h1>   
      {% if resource.url != None %}
      <p id="url-content"><a href="{{ resource.url }}" target="_blank">{{ resource.url }}</a></p>
      {% endif %}
      <p>{% if resource.text != None %}{{ resource.text }}{%else%}This resource has no description. <a href="/resources/{{resource.id}}/edit">Add one now!</a>{% endif %}</p> 
    </div>
    <div class="col-xs-4">
      <div class="row">
        <div class="btn-group btn-group-justified" role="group" style="margin: 20px;">
          <div class="btn-group">
            <button class="flat star-button {%if not user_relation.starred%}star-button-empty{%endif%} "  starred="{%if not user_relation.starred%}0{%else%}1{%endif%}" resource-id="{{ resource.id }}" type="button"><span class="glyphicon glyphicon-star{%if not user_relation.starred%}-empty{%endif%}"></span></button>
          </div>
          <div class="btn-group" type="button">
            <a href="/resources/edit/{{resource.id}}">Edit</a>
            <!-- <form action="/resources/edit/{{resource.id}}" method="GET">
              <a onclick="$(this).parent().submit();">Edit</a>
            </form> -->
          </div>
          <div class="btn-group" role="group">
            <button type="button" class="flat" data-toggle="dropdown" aria-expanded="false">
              <span class="glyphicon glyphicon-chevron-down"></span>
            </button>
            <ul class="dropdown-menu" role="menu">
              <li><a class="saveto-button" id="saveto-button-{{resource.id}}" resource-id="{{ resource.id }}">Pin to other Topic</a></li>
              <li><a href="/resources/delete/{{resource.id}}" style="color:red">Delete</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="row" style="background-color:#F7F7F7">
        <h4>Author</h4>
        <p>{{resource.author.username}}</p>
        <h4>Related Topics</h4>
        {% if user_relation.parent_info %}
          {% for parent in user_relation.parent_info|slice:":3" %}          
            <a href="/resources/{{parent.id}}"><p>{{parent.title|truncatechars:50}}</p></a>
          {% endfor %}
        {% else %}
          {% for parent in resource_list|slice:":3" %}          
            <a href="/resources/{{parent.id}}"><p>{{parent.title|truncatechars:50}}</p></a>
          {% endfor %}
        {% endif %}
      </div>
    </div>

    {% endif %}

  </div>

  <div class="row">
    <h3>Pinned</h3>
    {% include 'sodata/paginated.html' with resource_list=resource_list user_relations=user_relations page_number=1 parent=resource pinned=True%}
  </div>
  <div class="row" id="recommended-container" next-page-number="2">
  <!--  Put page 1 here automatically -->
    <h3>Recommended</h3>
    {% include 'sodata/paginated.html' with resource_list=recommended_resources user_relations=recommended_relations page_number=1 parent=resource%}
  </div>
  <div class="row">
    <p style="text-align:center"><a id="paginate-button">show more recommendations</a></p>
  </div>
</div>

{% endblock %}